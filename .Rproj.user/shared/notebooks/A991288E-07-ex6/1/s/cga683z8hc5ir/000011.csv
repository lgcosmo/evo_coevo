"0",""
"0","indirect_effects=function(incidence_matrix, m){"
"0","  "
"0","  # Getting adjacency matrix"
"0","  A=adjacency_matrix(incidence_matrix=incidence_matrix, binary=TRUE)"
"0","  "
"0","  n_sp=nrow(A)"
"0","  "
"0","  Q = A / rowSums(A) # Step (1)"
"0","  Q = Q * m # Step (1)"
"0","  "
"0","  Psi = diag((1-m), n_sp) # Step (1)"
"0","  I = diag(1, n_sp) # Creating identity matrix"
"0","  "
"0","  Tmat=(solve(I-Q)) %*% Psi # Step (2)"
"0","  "
"0","  Tmat_indirect=Tmat #Step (3)"
"0","  Tmat_indirect=Tmat_indirect*(1-A) #Step (3)"
"0","  "
"0","  ind_contrib=sum(Tmat_indirect)/sum(Tmat)"
"0","  "
"0","  return(ind_contrib)"
"0","  "
"0","}"
"0",""
"0","# Using the function"
"0",""
"0","ind = indirect_effects(incidence_matrix=net1, m=0.3)"
"0",""
