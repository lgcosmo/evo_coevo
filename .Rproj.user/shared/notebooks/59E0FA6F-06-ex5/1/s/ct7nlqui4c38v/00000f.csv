"0",""
"0","# Step (1)"
"0",""
"0","#Defining a function that takes as input the following parameters:"
"0",""
"0","#sx=Overall strength of ecological interactions on fitness of the victim species"
"0","#sy=Overall strength of ecological interactions on fitness of the exploiter species"
"0","#a=Parameter alpha of the model"
"0","#h=Heritability of the traits of both the victim and exploiter species (assumed to be equal)"
"0","#v_zx=Variance in the trait of the victim species"
"0","#z_vy=Variance in the trait of the exploiter species"
"0","#tmax=Maximum number of time steps (generations) of the simulation"
"0","#z0_x=Initial mean trait value of the population of the victim species"
"0","#z0_y=Initial mean trait value of the population of the exploiter species"
"0",""
"0","coevo<-function(sx, sy, a, h, v_zx, v_zy, tmax, z0_x, z0_y){ #Step (1)"
"0","  "
"0","  dzx = c() #Creating vector to store values of the mean trait value of the population of the victim species "
"0","  dzy = c() #Creating vector to store values of the mean trait value of the population of the exploiter species"
"0","  "
"0","  dzx[1] = z0_x #Setting initial mean trait value in the population of the victim species"
"0","  dzy[1] = z0_y #Setting initial mean trait value in the population of the exploiter species"
"0","  "
"0","  #For loop to iterate over the equation - here we will use Lande's equation"
"0","  for(t in 1:(tmax-1)){"
"0","    "
"0","    # Step (2)"
"0","    "
"0","    zx = dzx[t] #Setting the mean trait value at the current generation of the of the population of the victim species"
"0","    zy = dzy[t] #Setting the mean trait value at the current generation of the of the population of the exploiter species"
"0","    "
"0","    # Step (3)"
"0","    "
"0","    mx=sx*2*a*(exp(-a*((zx-zy)^2+v_zx+v_zy)))/(1-sx*exp(-a*((zx-zy)^2+v_zx+v_zy)))"
"0","    my=sy*2*a*(exp(-a*((zx-zy)^2+v_zx+v_zy)))/(1+sy*exp(-a*((zx-zy)^2+v_zx+v_zy)))"
"0","    "
"0","    dlnw1 = mx*(zx-zy)"
"0","    dlnw2 = my*(zx-zy)"
"0","    "
"0","    # Step (4)"
"0","    "
"0","    dzx[t+1]=zx + h*v_zx*dlnw1 #Using Lande's equation to compute mean trait value at the next generation of the population of the victim species"
"0","    dzy[t+1]=zy + h*v_zy*dlnw2 #Using Lande's equation to compute mean trait value at the next generation of the population of the exploiter species"
"0","    "
"0","  }"
"0","  "
"0","  r=data.frame(dzx, dzy, t=1:tmax) # Step (5), creating a data frame with mean trait values over time of the two species"
"0","  "
"0","  return(r)"
"0","  "
"0","}"
"0",""
